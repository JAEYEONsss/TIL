# Spring Security

## 작성계기
* 파란학기제에서 '식품 판매를 위한 플랫폼 제작' 프로젝트를 진행하면서 회원 정보와 관련된 서버 처리 부분을 맡게 되었다.   
스프링부트 프레임워크를 사용해서 프로젝트를 진행 중이다.   
우리 팀은 JWT를 이용해서 로그인을 진행하기로 했다. 이번 기회에 스프링 시큐리티와 JWT에 관한 지식을 쌓고자 작성하게 되었다.

## Spring Security란?
- 쉽게 말해서 로그인과 관련된 작업들을 처리해주는 프레임워크라고 생각하면 될 것 같다.   
개발자를 대신해서 어플리케이션 사용자의 로그인 처리 담당을 하는 역할이다.   
스프링 시큐리티를 이용하면 약간의 코드와 설정만으로 로그인 처리를 할 수 있다.  
하지만, 프레임워크를 활용하기 위해서는 충분한 학습이 필요하다.

## JWT란?
```
JSON 웹 토큰은 선택적 서명 및 선택적 암호화를 사용하여 데이터를 만들기 위한 인터넷 표준으로, 페이로드는 몇몇 클레임 표명을 처리하는 JSON을 보관하고 있다. 토큰은 비공개 시크릿 키 또는 공개/비공개 키를 사용하여 서명된다. - 출처: 위키백과
```
- JWT는 엄밀히 말해서 '인코딩된 문자열'이다.   
크게 'header, payload, signature'로 총 3 부분으로 구성되어있다.   
각 부분은 '.'을 이용해서 구분된다.

- payload에는 claim이라고 부르는 key/value로 구성된 정보를 저장한다.

## 프로젝트를 하면서 알게된 것들

### SecurityConfig
* 스프링 시큐리티를 학습하면서 볼 수 있는 설정 파일 중 대표적으로 볼 수 있는 것이다.   
스프링 시큐리티는 강력하고, 다양한 보안 기능을 제공해준다. 이 때, 모든 기능을 사용자가 요구하는 것은 아니다. 따라서, 개발자는 요구사항에 맞도록 보안 기능을 선택해서 사용해야 할 것이다.   
<b> 이 때, 사용되는 것이 SecurityConfig 클래스이다.</b>  
이 곳에서는 인증 방식, 권한 설정, 로그인 페이지 및 에러 페이지, 필터 설정 등 다양한 것을 설정할 수 있다.   
물론, 본인이 원하는 위치와 클래스에서 설정할 수 있지만 코드의 가독성 혹은 유지보수성 때문에 config 클래스를 작성한다고 생각하면 좋을 것 같다.

### SecurityFilterChain
* 스프링 시큐리티에서 보안 설정을 구성하는 인터페이스이다.

### UserDetailsService / UserDetails
* <b>UserDetailsService</b> : 스프링 시큐리티에서 제공하는 인터페이스 중 하나로 사용자 정보를 가져오는 loadUserByUsername 메소드를 갖고 있다.

* <b>UserDetails</b> : 사용자의 정보와 권한을 갖고 있는 객체이다.

* 즉, 사용자 인증 요청이 발생하면, UserDetailsService를 통해서 사용자 정보를 가져오고, 정보를 UserDetails 객체에 저장한다.

### AuthenticationManger
* 스프링 시큐리티에서 제공하는 인터페이스로 사용자 인증을 처리하는 역할을 한다.

## 프로젝트를 진행하며 내가 이해한 것
1. CustomSecurityConfig 클래스에서 로그인 처리와 관련된 기능을 설정해준다.
2. SecurityFilterChain 에서 로그인 처리와 관련된 것들을 해주면 된다. 즉, 로그인 인증 과정, jwt 토큰 발급과 같은 것들을 얘기하는 것이다. 따라서, 다음 3번에 나오는 것들도 SecurityFilterChain 내에서 처리하도록 정의하거나 메소드를 실행하면 된다.
3. CustomSecurityConfig 클래스에서 userDetailsService 구현 객체를 AuthenticationManger로 설정해주고, 그것을 활용해서 db에 저장된 사용자 정보 (id, pwd)와 대조해서 로그인을 처리한다.